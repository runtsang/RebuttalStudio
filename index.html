<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rebuttal Studio Dashboard</title>
    <style>
      :root {
        color-scheme: light dark;
        --radius-sm: 10px;
        --radius-md: 14px;
        --radius-lg: 18px;
        --space-1: 8px;
        --space-2: 12px;
        --space-3: 16px;
        --space-4: 24px;
        --space-5: 32px;
        --trans: 180ms ease;
        --shadow-soft: 0 4px 12px rgba(20, 20, 20, 0.07);
      }

      @media (prefers-color-scheme: light) {
        :root {
          --bg: #f3f3f3;
          --panel: #fafafa;
          --panel-muted: #efefef;
          --text: #242424;
          --text-muted: #6d6d6d;
          --border: #dfdfdf;
          --hover: #e8e8e8;
          --rainbow-soft: conic-gradient(from 90deg, #b6c3ef, #d5bee8, #eac6c0, #c0d5c3, #b6cce7, #b6c3ef);
        }
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --bg: #1f1f1f;
          --panel: #262626;
          --panel-muted: #2b2b2b;
          --text: #e6e6e6;
          --text-muted: #afafaf;
          --border: #3a3a3a;
          --hover: #323232;
          --rainbow-soft: conic-gradient(from 90deg, #6f78a4, #86709a, #a1817b, #708e72, #6f8ba6, #6f78a4);
        }
      }

      * { box-sizing: border-box; }
      body {
        margin: 0;
        min-height: 100vh;
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        background: var(--bg);
        color: var(--text);
      }

      button, input, textarea { font: inherit; }

      .app { display: grid; grid-template-columns: 260px 1fr; min-height: 100vh; }

      .sidebar {
        position: sticky;
        top: 0;
        height: 100vh;
        border-right: 1px solid var(--border);
        background: var(--panel);
        padding: var(--space-4) var(--space-3);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      .sidebar-title { font-size: 0.95rem; margin: 0 0 var(--space-3); color: var(--text-muted); }
      .project-nav { display: grid; gap: var(--space-1); }

      .project-item {
        border: 1px solid transparent;
        border-radius: var(--radius-sm);
        padding: 10px 12px;
        text-decoration: none;
        color: var(--text);
        transition: background var(--trans), border-color var(--trans);
      }

      .project-item:hover { background: var(--hover); border-color: var(--border); }

      .settings-btn {
        border: 1px solid var(--border);
        background: var(--panel-muted);
        color: var(--text-muted);
        border-radius: 999px;
        width: 34px;
        height: 34px;
        display: grid;
        place-items: center;
        cursor: pointer;
      }

      .main { min-width: 0; display: flex; flex-direction: column; }

      .topbar {
        position: sticky;
        top: 0;
        z-index: 8;
        border-bottom: 1px solid var(--border);
        background: color-mix(in srgb, var(--panel) 92%, transparent);
        backdrop-filter: blur(8px);
        padding: var(--space-3) var(--space-4);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: var(--space-3);
      }

      .topbar-left,
      .topbar-right { display: flex; align-items: center; gap: var(--space-2); }

      .logo {
        font-size: 1.05rem;
        font-weight: 600;
        letter-spacing: 0.01em;
      }

      .btn {
        border: 1px solid var(--border);
        background: var(--panel-muted);
        color: var(--text);
        border-radius: var(--radius-sm);
        padding: 9px 14px;
        cursor: pointer;
        transition: all var(--trans);
      }

      .btn:hover { background: var(--hover); }
      .btn.primary { background: var(--text); color: var(--panel); border-color: transparent; box-shadow: var(--shadow-soft); }
      .btn.primary:hover { transform: translateY(-1px); }

      .icon-btn {
        width: 38px;
        height: 38px;
        border-radius: 12px;
        border: 1px solid var(--border);
        background: var(--panel-muted);
        color: var(--text);
        cursor: pointer;
      }

      .content {
        flex: 1;
        padding: var(--space-4);
        display: grid;
        align-content: start;
        gap: var(--space-3);
      }

      .step-indicator {
        display: none;
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        padding: var(--space-2) var(--space-3);
        box-shadow: var(--shadow-soft);
      }

      .step-list {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }

      .step-node {
        width: 34px;
        height: 34px;
        border-radius: 999px;
        border: 1px solid var(--border);
        display: grid;
        place-items: center;
        background: var(--panel-muted);
        color: var(--text-muted);
        position: relative;
      }

      .step-node.active {
        color: var(--text);
        border-color: transparent;
        background: var(--panel);
      }

      .step-node.active::before {
        content: '';
        position: absolute;
        inset: -2px;
        border-radius: inherit;
        padding: 2px;
        background: var(--rainbow-soft);
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
      }

      .empty-state {
        margin: auto;
        text-align: center;
        max-width: 460px;
      }

      .empty-state h1 { margin: 0 0 var(--space-2); font-size: clamp(1.5rem, 3vw, 2rem); }
      .empty-state p { margin: 0 0 var(--space-4); color: var(--text-muted); }

      .workflow-workspace {
        display: none;
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        background: var(--panel);
        padding: var(--space-3);
      }

      .workspace-layout {
        display: grid;
        grid-template-columns: minmax(300px, 1fr) 96px minmax(280px, 1fr);
        gap: var(--space-3);
        align-items: stretch;
      }

      .panel {
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        background: var(--panel);
        padding: var(--space-3);
        min-height: 420px;
      }

      .reviewer-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-2); }
      .reviewer-header h3 { margin: 0; font-size: 1rem; }

      .reviewer-list { display: flex; gap: var(--space-1); flex-wrap: wrap; margin-bottom: var(--space-2); }

      .reviewer-pill {
        border: 1px solid var(--border);
        background: var(--panel-muted);
        color: var(--text);
        border-radius: 999px;
        padding: 6px 12px;
        cursor: pointer;
      }

      .reviewer-pill.active { background: var(--hover); }

      .input-wrap { position: relative; }

      .reviewer-input {
        width: 100%;
        min-height: 300px;
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        background: var(--panel-muted);
        color: var(--text);
        padding: var(--space-3);
        resize: vertical;
      }

      .input-helper {
        position: absolute;
        inset: 0;
        display: grid;
        place-items: center;
        text-align: center;
        color: var(--text-muted);
        pointer-events: none;
        padding: var(--space-4);
        transition: opacity var(--trans);
      }

      .input-helper.hidden { opacity: 0; }

      .flow-hint {
        display: grid;
        place-content: center;
        text-align: center;
        color: var(--text-muted);
        gap: var(--space-1);
      }

      .flow-arrow { font-size: 2rem; color: var(--text); }
      .flow-caption { font-size: 0.84rem; }

      .output-empty {
        min-height: 300px;
        border: 1px dashed var(--border);
        border-radius: var(--radius-sm);
        background: color-mix(in srgb, var(--panel-muted) 86%, transparent);
        display: grid;
        place-content: center;
        text-align: center;
        padding: var(--space-4);
      }

      .output-empty h3 { margin: 0 0 var(--space-1); }
      .output-empty p { margin: 0; color: var(--text-muted); }

      .modal-backdrop {
        position: fixed;
        inset: 0;
        display: none;
        place-items: center;
        background: color-mix(in srgb, #000 25%, transparent);
        backdrop-filter: blur(5px);
      }

      .modal {
        width: min(440px, calc(100% - 32px));
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
      }

      .api-input {
        width: 100%;
        margin: var(--space-2) 0 var(--space-4);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        padding: 10px 12px;
        background: var(--panel-muted);
        color: var(--text);
      }

      .modal-actions { display: flex; justify-content: flex-end; gap: var(--space-2); }
      .show { display: grid !important; }

      @media (max-width: 980px) {
        .app { grid-template-columns: 1fr; }
        .sidebar { position: static; height: auto; border-right: none; border-bottom: 1px solid var(--border); }
        .workspace-layout { grid-template-columns: 1fr; }
      }
    </style>
  </head>
  <body>
    <div class="app">
      <aside class="sidebar">
        <div>
          <h2 class="sidebar-title">Your Projects</h2>
          <nav class="project-nav" aria-label="Project navigation">
            <a class="project-item" href="#">All Projects</a>
            <a class="project-item" href="#">Hosted</a>
            <a class="project-item" href="#">Archived</a>
          </nav>
        </div>
        <button class="settings-btn" aria-label="Settings">⚙</button>
      </aside>

      <main class="main">
        <header class="topbar">
          <div class="topbar-left">
            <div class="logo">Rebuttal Studio</div>
            <button id="apiOpenBtn" class="btn">Enter API</button>
          </div>
          <div class="topbar-right">
            <button id="viewToggle" class="icon-btn" aria-label="Toggle project view">☷</button>
            <button id="newBtn" class="btn primary">+ New</button>
          </div>
        </header>

        <section class="content">
          <div id="stepIndicator" class="step-indicator" aria-live="polite"></div>

          <div id="emptyState" class="empty-state">
            <h1>You don’t have any projects yet</h1>
            <p>Start by creating a new hosted project</p>
            <button id="startScratchBtn" class="btn primary">Start from Scratch</button>
          </div>

          <div id="workflowWorkspace" class="workflow-workspace" aria-live="polite"></div>
        </section>
      </main>
    </div>

    <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="apiTitle">
      <div class="modal">
        <h2 id="apiTitle">Enter Your API Key</h2>
        <input id="apiInput" class="api-input" type="password" placeholder="sk-..." />
        <div class="modal-actions">
          <button id="cancelBtn" class="btn">Cancel</button>
          <button id="saveBtn" class="btn primary">Save</button>
        </div>
      </div>
    </div>

    <script>
      const apiOpenBtn = document.getElementById('apiOpenBtn');
      const modalBackdrop = document.getElementById('modalBackdrop');
      const cancelBtn = document.getElementById('cancelBtn');
      const saveBtn = document.getElementById('saveBtn');
      const apiInput = document.getElementById('apiInput');
      const newBtn = document.getElementById('newBtn');
      const startScratchBtn = document.getElementById('startScratchBtn');

      const emptyStateEl = document.getElementById('emptyState');
      const stepIndicatorEl = document.getElementById('stepIndicator');
      const workflowWorkspaceEl = document.getElementById('workflowWorkspace');

      const steps = [1, 2, 3, 4];
      let workflowActive = false;
      let currentStep = 1;
      let reviewers = [{ name: 'Reviewer 1', content: '' }];
      let selectedReviewer = 0;

      function openModal() {
        modalBackdrop.classList.add('show');
        apiInput.focus();
      }

      function closeModal() {
        modalBackdrop.classList.remove('show');
      }

      function resetWorkflowState() {
        currentStep = 1;
        reviewers = [{ name: 'Reviewer 1', content: '' }];
        selectedReviewer = 0;
      }

      function renderStepIndicator() {
        stepIndicatorEl.innerHTML = `
          <ol class="step-list" aria-label="Project step status">
            ${steps
              .map((step) => `<li class="step-node ${step === currentStep ? 'active' : ''}" aria-current="${step === currentStep}">${step}</li>`)
              .join('')}
          </ol>
        `;
      }

      function renderReviewers() {
        return reviewers
          .map((reviewer, index) => `<button class="reviewer-pill ${index === selectedReviewer ? 'active' : ''}" data-reviewer-index="${index}">${reviewer.name}</button>`)
          .join('');
      }

      function renderWorkflowWorkspace() {
        const selected = reviewers[selectedReviewer];
        const hasText = selected.content.trim().length > 0;

        workflowWorkspaceEl.innerHTML = `
          <div class="workspace-layout">
            <section class="panel">
              <div class="reviewer-header">
                <h3>Reviewers</h3>
                <button id="addReviewerBtn" class="btn" aria-label="Add reviewer">+</button>
              </div>
              <div class="reviewer-list">${renderReviewers()}</div>
              <div class="input-wrap">
                <textarea id="reviewerInput" class="reviewer-input" aria-label="Reviewer profile input">${selected.content}</textarea>
                <div class="input-helper ${hasText ? 'hidden' : ''}">
                  <div>
                    <div>Paste ${selected.name}’s full review here.</div>
                    <div>You can directly copy and paste the entire reviewer feedback.</div>
                  </div>
                </div>
              </div>
            </section>

            <div class="flow-hint" aria-hidden="true">
              <div class="flow-arrow">→</div>
              <div class="flow-caption">API-assisted breakdown (placeholder)</div>
            </div>

            <section class="panel">
              <div class="output-empty">
                <div>
                  <h3>Structured Breakdown</h3>
                  <p>This panel will display the decomposed points and analysis after processing.</p>
                </div>
              </div>
            </section>
          </div>
        `;
      }

      function renderPage() {
        stepIndicatorEl.style.display = workflowActive ? 'block' : 'none';
        workflowWorkspaceEl.style.display = workflowActive ? 'grid' : 'none';
        emptyStateEl.style.display = workflowActive ? 'none' : 'block';

        if (workflowActive) {
          renderStepIndicator();
          renderWorkflowWorkspace();
        }
      }

      function startNewProject() {
        workflowActive = true;
        resetWorkflowState();
        renderPage();
      }

      apiOpenBtn.addEventListener('click', openModal);
      cancelBtn.addEventListener('click', closeModal);
      saveBtn.addEventListener('click', closeModal);
      modalBackdrop.addEventListener('click', (event) => {
        if (event.target === modalBackdrop) {
          closeModal();
        }
      });

      newBtn.addEventListener('click', startNewProject);
      startScratchBtn.addEventListener('click', startNewProject);

      workflowWorkspaceEl.addEventListener('click', (event) => {
        const addBtn = event.target.closest('#addReviewerBtn');
        if (addBtn) {
          const nextIndex = reviewers.length + 1;
          reviewers.push({ name: `Reviewer ${nextIndex}`, content: '' });
          selectedReviewer = reviewers.length - 1;
          renderPage();
          return;
        }

        const reviewerBtn = event.target.closest('.reviewer-pill');
        if (reviewerBtn) {
          selectedReviewer = Number(reviewerBtn.dataset.reviewerIndex);
          renderPage();
        }
      });

      workflowWorkspaceEl.addEventListener('input', (event) => {
        if (event.target.id === 'reviewerInput') {
          reviewers[selectedReviewer].content = event.target.value;
          const helper = workflowWorkspaceEl.querySelector('.input-helper');
          if (helper) {
            helper.classList.toggle('hidden', event.target.value.trim().length > 0);
          }
        }
      });

      renderPage();
    </script>
  </body>
</html>
